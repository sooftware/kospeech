

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Model &mdash; End-to-end Speech Recognition 2.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data" href="Data.html" />
    <link rel="prev" title="Options" href="notes/opts.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> End-to-end Speech Recognition
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notes/intro.html">Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/preparation.html">Preparation before Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/opts.html">Options</a></li>
</ul>
<p class="caption"><span class="caption-text">ARCHITECTURE</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.sub_layers.baseRNN">BaseRNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.sub_layers.extractor">Extractor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.sub_layers.maskCNN">MaskCNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.las">ListenAttendSpell</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.listener">Listener</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.speller">Speller</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.beam_search">BeamSearch</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.attention">Attention</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">PACKAGE REFERENCE</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Data.html">Data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.sub_layers.baseRNN">BaseRNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.sub_layers.extractor">Extractor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.sub_layers.maskCNN">MaskCNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.las">ListenAttendSpell</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.listener">Listener</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.speller">Speller</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.beam_search">BeamSearch</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-e2e.model.attention">Attention</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Optim.html">Optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solver.html">Solver</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">End-to-end Speech Recognition</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Model</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Model.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="model">
<h1>Model<a class="headerlink" href="#model" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-e2e.model.sub_layers.baseRNN">
<span id="basernn"></span><h2>BaseRNN<a class="headerlink" href="#module-e2e.model.sub_layers.baseRNN" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="e2e.model.sub_layers.baseRNN.BaseRNN">
<em class="property">class </em><code class="descclassname">e2e.model.sub_layers.baseRNN.</code><code class="descname">BaseRNN</code><span class="sig-paren">(</span><em>input_size</em>, <em>hidden_dim</em>, <em>num_layers</em>, <em>rnn_type</em>, <em>dropout_p</em>, <em>bidirectional</em>, <em>device</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/sub_layers/baseRNN.html#BaseRNN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.sub_layers.baseRNN.BaseRNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a multi-layer RNN to an input sequence.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Do not use this class directly, use one of the sub classes.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – size of input</li>
<li><strong>hidden_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of features in the hidden state <cite>h</cite></li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – number of recurrent layers (default: 1)</li>
<li><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – if True, becomes a bidirectional encoder (defulat: False)</li>
<li><strong>rnn_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – type of RNN cell (default: gru)</li>
<li><strong>dropout_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – dropout probability (default: 0)</li>
<li><strong>device</strong> (<em>torch.device</em>) – device - ‘cuda’ or ‘cpu’</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><p class="first last"><strong>= Dictionary of supported rnns</strong> (<em>supported_rnns</em>) – </p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="e2e.model.sub_layers.baseRNN.BaseRNN.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/sub_layers/baseRNN.html#BaseRNN.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.sub_layers.baseRNN.BaseRNN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-e2e.model.sub_layers.extractor">
<span id="extractor"></span><h2>Extractor<a class="headerlink" href="#module-e2e.model.sub_layers.extractor" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="e2e.model.sub_layers.extractor.DeepSpeech2Extractor">
<em class="property">class </em><code class="descclassname">e2e.model.sub_layers.extractor.</code><code class="descname">DeepSpeech2Extractor</code><span class="sig-paren">(</span><em>in_channels=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/sub_layers/extractor.html#DeepSpeech2Extractor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.sub_layers.extractor.DeepSpeech2Extractor" title="Permalink to this definition">¶</a></dt>
<dd><p>VGG extractor for automatic speech recognition described in
“Advances in Joint CTC-Attention based End-to-End Speech Recognition with “a Deep CNN Encoder and RNN-LM” paper
- <a class="reference external" href="https://arxiv.org/pdf/1706.02737.pdf">https://arxiv.org/pdf/1706.02737.pdf</a></p>
<dl class="method">
<dt id="e2e.model.sub_layers.extractor.DeepSpeech2Extractor.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>inputs</em>, <em>input_lengths</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/sub_layers/extractor.html#DeepSpeech2Extractor.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.sub_layers.extractor.DeepSpeech2Extractor.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="e2e.model.sub_layers.extractor.VGGExtractor">
<em class="property">class </em><code class="descclassname">e2e.model.sub_layers.extractor.</code><code class="descname">VGGExtractor</code><span class="sig-paren">(</span><em>in_channels=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/sub_layers/extractor.html#VGGExtractor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.sub_layers.extractor.VGGExtractor" title="Permalink to this definition">¶</a></dt>
<dd><p>VGG extractor for automatic speech recognition described in
“Advances in Joint CTC-Attention based End-to-End Speech Recognition with “a Deep CNN Encoder and RNN-LM” paper
- <a class="reference external" href="https://arxiv.org/pdf/1706.02737.pdf">https://arxiv.org/pdf/1706.02737.pdf</a></p>
<dl class="method">
<dt id="e2e.model.sub_layers.extractor.VGGExtractor.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>inputs</em>, <em>input_lengths</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/sub_layers/extractor.html#VGGExtractor.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.sub_layers.extractor.VGGExtractor.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-e2e.model.sub_layers.maskCNN">
<span id="maskcnn"></span><h2>MaskCNN<a class="headerlink" href="#module-e2e.model.sub_layers.maskCNN" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="e2e.model.sub_layers.maskCNN.MaskCNN">
<em class="property">class </em><code class="descclassname">e2e.model.sub_layers.maskCNN.</code><code class="descname">MaskCNN</code><span class="sig-paren">(</span><em>sequential</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/sub_layers/maskCNN.html#MaskCNN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.sub_layers.maskCNN.MaskCNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Masking Convolutional Neural Network</p>
<p>Adds padding to the output of the module based on the given lengths.
This is to ensure that the results of the model do not change when batch sizes change during inference.
Input needs to be in the shape of (batch_size, channel, hidden_dim, seq_len)</p>
<p>Refer to <a class="reference external" href="https://github.com/SeanNaren/deepspeech.pytorch/blob/master/model.py">https://github.com/SeanNaren/deepspeech.pytorch/blob/master/model.py</a>
Copyright (c) 2017 Sean Naren
MIT License</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sequential</strong> (<em>torch.nn</em>) – sequential list of convolution layer</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Inputs: inputs, seq_lengths</dt>
<dd><ul class="first last simple">
<li><strong>inputs</strong> (torch.FloatTensor): The input of size BxCxHxS</li>
<li><strong>seq_lengths</strong> (torch.IntTensor): The actual length of each sequence in the batch</li>
</ul>
</dd>
<dt>Returns: output, seq_lengths</dt>
<dd><ul class="first last simple">
<li><strong>output</strong>: Masked output from the sequential</li>
<li><strong>seq_lengths</strong>: Sequence length of output from the sequential</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="e2e.model.sub_layers.maskCNN.MaskCNN.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>inputs</em>, <em>seq_lengths</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/sub_layers/maskCNN.html#MaskCNN.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.sub_layers.maskCNN.MaskCNN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="e2e.model.sub_layers.maskCNN.MaskCNN.get_seq_lengths">
<code class="descname">get_seq_lengths</code><span class="sig-paren">(</span><em>module</em>, <em>seq_lengths</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/sub_layers/maskCNN.html#MaskCNN.get_seq_lengths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.sub_layers.maskCNN.MaskCNN.get_seq_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate convolutional neural network receptive formula</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>module</strong> (<a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch vmaster (1.6.0a0+8556664 ))"><em>torch.nn.Module</em></a>) – module of CNN</li>
<li><strong>seq_lengths</strong> (<em>torch.IntTensor</em>) – The actual length of each sequence in the batch</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns: seq_lengths</dt>
<dd><ul class="first last simple">
<li><strong>seq_lengths</strong>: Sequence length of output from the module</li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-e2e.model.las">
<span id="listenattendspell"></span><h2>ListenAttendSpell<a class="headerlink" href="#module-e2e.model.las" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="e2e.model.las.ListenAttendSpell">
<em class="property">class </em><code class="descclassname">e2e.model.las.</code><code class="descname">ListenAttendSpell</code><span class="sig-paren">(</span><em>listener</em>, <em>speller</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/las.html#ListenAttendSpell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.las.ListenAttendSpell" title="Permalink to this definition">¶</a></dt>
<dd><p>Listen, Attend and Spell (LAS) Model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>listener</strong> (<a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch vmaster (1.6.0a0+8556664 ))"><em>torch.nn.Module</em></a>) – encoder of seq2seq</li>
<li><strong>speller</strong> (<a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch vmaster (1.6.0a0+8556664 ))"><em>torch.nn.Module</em></a>) – decoder of seq2seq</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Inputs: inputs, input_lengths, targets, teacher_forcing_ratio</dt>
<dd><ul class="first last simple">
<li><strong>inputs</strong> (torch.Tensor): tensor of sequences, whose length is the batch size and within which
each sequence is a list of token IDs. This information is forwarded to the encoder.</li>
<li><strong>input_lengths</strong> (torch.Tensor): tensor of sequences, whose contains length of inputs.</li>
<li><strong>targets</strong> (torch.Tensor): tensor of sequences, whose length is the batch size and within which
each sequence is a list of token IDs. This information is forwarded to the decoder.</li>
<li><strong>teacher_forcing_ratio</strong> (float): The probability that teacher forcing will be used. A random number
is drawn uniformly from 0-1 for every decoding token, and if the sample is smaller than the given value,
teacher forcing would be used (default is 0.90)</li>
</ul>
</dd>
<dt>Returns: output</dt>
<dd><ul class="first last simple">
<li><strong>output</strong> (seq_len, batch_size, num_classes): list of tensors containing
the outputs of the decoding function.</li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">listener</span> <span class="o">=</span> <span class="n">Listener</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">speller</span> <span class="o">=</span> <span class="n">Speller</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ListenAttendSpell</span><span class="p">(</span><span class="n">listener</span><span class="p">,</span> <span class="n">speller</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logit</span> <span class="o">=</span> <span class="n">model</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="e2e.model.las.ListenAttendSpell.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>inputs</em>, <em>input_lengths</em>, <em>targets=None</em>, <em>teacher_forcing_ratio=0.99</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/las.html#ListenAttendSpell.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.las.ListenAttendSpell.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-e2e.model.listener">
<span id="listener"></span><h2>Listener<a class="headerlink" href="#module-e2e.model.listener" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="e2e.model.listener.Listener">
<em class="property">class </em><code class="descclassname">e2e.model.listener.</code><code class="descname">Listener</code><span class="sig-paren">(</span><em>input_size</em>, <em>hidden_dim</em>, <em>device</em>, <em>dropout_p=0.5</em>, <em>num_layers=1</em>, <em>bidirectional=True</em>, <em>rnn_type='gru'</em>, <em>extractor='vgg'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/listener.html#Listener"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.listener.Listener" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts low level speech signals into higher level features</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – size of input</li>
<li><strong>hidden_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of features in the hidden state <cite>h</cite></li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – number of recurrent layers (default: 1)</li>
<li><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – if True, becomes a bidirectional encoder (defulat: False)</li>
<li><strong>rnn_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – type of RNN cell (default: gru)</li>
<li><strong>dropout_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – dropout probability (default: 0)</li>
<li><strong>device</strong> (<em>torch.device</em>) – device - ‘cuda’ or ‘cpu’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Inputs: inputs, hidden</dt>
<dd><ul class="first last simple">
<li><strong>inputs</strong>: list of sequences, whose length is the batch size and within which each sequence is list of tokens</li>
<li><strong>hidden</strong>: variable containing the features in the hidden state h</li>
</ul>
</dd>
<dt>Returns: output</dt>
<dd><ul class="first last simple">
<li><strong>output</strong>: tensor containing the encoded features of the input sequence</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="e2e.model.listener.Listener.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>inputs</em>, <em>input_lengths</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/listener.html#Listener.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.listener.Listener.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-e2e.model.speller">
<span id="speller"></span><h2>Speller<a class="headerlink" href="#module-e2e.model.speller" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="e2e.model.speller.Speller">
<em class="property">class </em><code class="descclassname">e2e.model.speller.</code><code class="descname">Speller</code><span class="sig-paren">(</span><em>num_classes</em>, <em>max_length</em>, <em>hidden_dim</em>, <em>sos_id</em>, <em>eos_id</em>, <em>attn_mechanism='loc'</em>, <em>num_heads=8</em>, <em>num_layers=1</em>, <em>rnn_type='gru'</em>, <em>dropout_p=0.5</em>, <em>device=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/speller.html#Speller"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.speller.Speller" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts higher level features (from listener) into output utterances
by specifying a probability distribution over sequences of characters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of classfication</li>
<li><strong>max_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – a maximum allowed length for the sequence to be processed</li>
<li><strong>hidden_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of features in the hidden state <cite>h</cite></li>
<li><strong>sos_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – index of the start of sentence symbol</li>
<li><strong>eos_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – index of the end of sentence symbol</li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – number of recurrent layers (default: 1)</li>
<li><strong>rnn_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – type of RNN cell (default: gru)</li>
<li><strong>dropout_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – dropout probability (default: 0)</li>
<li><strong>device</strong> (<em>torch.device</em>) – device - ‘cuda’ or ‘cpu’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Inputs: inputs, listener_outputs, teacher_forcing_ratio</dt>
<dd><ul class="first last simple">
<li><strong>inputs</strong> (batch, seq_len, input_size): list of sequences, whose length is the batch size and within which
each sequence is a list of token IDs.  It is used for teacher forcing when provided. (default <cite>None</cite>)</li>
<li><strong>listener_outputs</strong> (batch, seq_len, hidden_dim): tensor with containing the outputs of the listener.
Used for attention mechanism (default is <cite>None</cite>).</li>
<li><strong>teacher_forcing_ratio</strong> (float): The probability that teacher forcing will be used. A random number is
drawn uniformly from 0-1 for every decoding token, and if the sample is smaller than the given value,
teacher forcing would be used (default is 0).</li>
</ul>
</dd>
<dt>Returns: decoder_outputs</dt>
<dd><ul class="first last simple">
<li><strong>decoder_outputs</strong>: list of tensors containing the outputs of the decoding function.</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="e2e.model.speller.Speller.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>inputs</em>, <em>listener_outputs</em>, <em>teacher_forcing_ratio=0.9</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/speller.html#Speller.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.speller.Speller.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="e2e.model.speller.Speller.validate_args">
<code class="descname">validate_args</code><span class="sig-paren">(</span><em>inputs</em>, <em>listener_outputs</em>, <em>teacher_forcing_ratio</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/speller.html#Speller.validate_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.speller.Speller.validate_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate arguments</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-e2e.model.beam_search">
<span id="beamsearch"></span><h2>BeamSearch<a class="headerlink" href="#module-e2e.model.beam_search" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="e2e.model.beam_search.BeamSearch">
<em class="property">class </em><code class="descclassname">e2e.model.beam_search.</code><code class="descname">BeamSearch</code><span class="sig-paren">(</span><em>decoder</em>, <em>k</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/beam_search.html#BeamSearch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.beam_search.BeamSearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Top-K decoding with beam search.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>decoder</strong> (<em>nn.Module</em>) – decoder to which beam search will be applied</li>
<li><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – size of beam</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Inputs: input_var, encoder_outputs</dt>
<dd><ul class="first last simple">
<li><strong>input_var</strong> : sequence of sos_id</li>
<li><strong>encoder_outputs</strong> : tensor containing the encoded features of the input sequence</li>
</ul>
</dd>
<dt>Returns: decoder_outputs</dt>
<dd><ul class="first last simple">
<li><strong>decoder_outputs</strong> :  list of tensors containing the outputs of the decoding function.</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="e2e.model.beam_search.BeamSearch.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>input_var</em>, <em>encoder_outputs</em>, <em>teacher_forcing_ratio=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/beam_search.html#BeamSearch.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.beam_search.BeamSearch.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-e2e.model.attention">
<span id="attention"></span><h2>Attention<a class="headerlink" href="#module-e2e.model.attention" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="e2e.model.attention.LocationAwareAttention">
<em class="property">class </em><code class="descclassname">e2e.model.attention.</code><code class="descname">LocationAwareAttention</code><span class="sig-paren">(</span><em>hidden_dim</em>, <em>num_heads=8</em>, <em>conv_out_channel=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/attention.html#LocationAwareAttention"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.attention.LocationAwareAttention" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a multi-headed location-aware attention mechanism on the output features from the decoder.
Location-aware attention proposed in “Attention-Based Models for Speech Recognition” paper.
The location-aware attention mechanism is performing well in speech recognition tasks.
In the above paper applied a signle head, but we applied multi head concept.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hidden_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of expected features in the output</li>
<li><strong>num_heads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of heads. (default: )</li>
<li><strong>conv_out_channel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of out channel in convolution</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Inputs: query, value, prev_attn</dt>
<dd><ul class="first last simple">
<li><strong>query</strong> (batch, q_len, hidden_dim): tensor containing the output features from the decoder.</li>
<li><strong>value</strong> (batch, v_len, hidden_dim): tensor containing features of the encoded input sequence.</li>
<li><strong>prev_attn</strong> (batch_size * num_heads, v_len): tensor containing previous timestep`s attention (alignment)</li>
</ul>
</dd>
<dt>Returns: output, attn</dt>
<dd><ul class="first last simple">
<li><strong>output</strong> (batch, output_len, dimensions): tensor containing the feature from encoder outputs</li>
<li><strong>attn</strong> (batch * num_heads, v_len): tensor containing the attention (alignment) from the encoder outputs.</li>
</ul>
</dd>
<dt>Reference:</dt>
<dd><ul class="first last simple">
<li><strong>Attention Is All You Need</strong>: <a class="reference external" href="https://arxiv.org/abs/1706.03762">https://arxiv.org/abs/1706.03762</a></li>
<li><strong>Attention-Based Models for Speech Recognition</strong>: <a class="reference external" href="https://arxiv.org/abs/1506.07503">https://arxiv.org/abs/1506.07503</a></li>
<li><strong>State-Of-The-Art Speech Recognition with Sequence-to-Sequence Models</strong>: <a class="reference external" href="https://arxiv.org/abs/1712.01769">https://arxiv.org/abs/1712.01769</a></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="e2e.model.attention.LocationAwareAttention.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>query</em>, <em>value</em>, <em>prev_attn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/attention.html#LocationAwareAttention.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.attention.LocationAwareAttention.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="e2e.model.attention.MultiHeadAttention">
<em class="property">class </em><code class="descclassname">e2e.model.attention.</code><code class="descname">MultiHeadAttention</code><span class="sig-paren">(</span><em>hidden_dim</em>, <em>num_heads=8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/attention.html#MultiHeadAttention"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.attention.MultiHeadAttention" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a multi-headed scaled dot mechanism on the output features from the decoder.
Multi-head attention proposed in “Attention Is All You Need” paper.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hidden_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of expected features in the output</li>
<li><strong>num_heads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of heads. (default: )</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Inputs: query, value, prev_align</dt>
<dd><ul class="first last simple">
<li><strong>query</strong> (batch, q_len, hidden_dim): tensor containing the output features from the decoder.</li>
<li><strong>value</strong> (batch, v_len, hidden_dim): tensor containing features of the encoded input sequence.</li>
</ul>
</dd>
<dt>Returns: output, attn</dt>
<dd><ul class="first last simple">
<li><strong>output</strong> (batch, output_len, dimensions): tensor containing the attended output features from the decoder.</li>
<li><strong>attn</strong>: tensor containing the attention (alignment) from the encoder outputs.</li>
</ul>
</dd>
<dt>Reference:</dt>
<dd><ul class="first last simple">
<li><strong>Attention Is All You Need</strong>: <a class="reference external" href="https://arxiv.org/abs/1706.03762">https://arxiv.org/abs/1706.03762</a></li>
<li><strong>State-Of-The-Art Speech Recognition with Sequence-to-Sequence Models</strong>: <a class="reference external" href="https://arxiv.org/abs/1712.01769">https://arxiv.org/abs/1712.01769</a></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="e2e.model.attention.MultiHeadAttention.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>query</em>, <em>value</em>, <em>prev_attn=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/attention.html#MultiHeadAttention.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.attention.MultiHeadAttention.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="e2e.model.attention.ScaledDotProductAttention">
<em class="property">class </em><code class="descclassname">e2e.model.attention.</code><code class="descname">ScaledDotProductAttention</code><span class="sig-paren">(</span><em>dim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/attention.html#ScaledDotProductAttention"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.attention.ScaledDotProductAttention" title="Permalink to this definition">¶</a></dt>
<dd><p>Scaled Dot-product Attention</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – dimention of attention</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Inputs: query, value</dt>
<dd><ul class="first last simple">
<li><strong>query</strong> (batch_size, q_len, hidden_dim): tensor containing the output features from the decoder.</li>
<li><strong>value</strong> (batch_size, v_len, hidden_dim): tensor containing features of the encoded input sequence.</li>
</ul>
</dd>
<dt>Returns: context, attn</dt>
<dd><ul class="first last simple">
<li><strong>context</strong>: tensor containing the context vector from attention mechanism.</li>
<li><strong>attn</strong>: tensor containing the attention (alignment) from the encoder outputs.</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="e2e.model.attention.ScaledDotProductAttention.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>query</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/e2e/model/attention.html#ScaledDotProductAttention.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#e2e.model.attention.ScaledDotProductAttention.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Data.html" class="btn btn-neutral float-right" title="Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="notes/opts.html" class="btn btn-neutral float-left" title="Options" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Soohwan Kim

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>